<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>BIOHERTS Tickets</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: blob:; script-src 'self' 'unsafe-inline' https://accounts.google.com https://apis.google.com https://*.gstatic.com https://cdn.socket.io; img-src 'self' data: https:; connect-src *; frame-src 'self' https://accounts.google.com https://*.gstatic.com; style-src 'self' 'unsafe-inline';">
  <style>
    :root{--bg:#eef2f6;--bg2:#fcfdfe;--brd:#cbd5e1;--txt:#1e293b;--mut:#64748b;--naranja:#f97316;--blue:#3b82f6;--green:#10b981;--nsoft:#f9731633;--gris:#94a3b8;--r1:16px;--r2:12px;--t:.2s ease;
      --body-bg: #dde1e7;
      --grad-color: #b3c2d1;
    }
    *{box-sizing:border-box;font-family:'Segoe UI', system-ui, sans-serif}
    body{margin:0;color:var(--txt);min-height:100vh;background-color:var(--body-bg);background-image:radial-gradient(farthest-corner at 0% 0%, var(--grad-color) 0%, transparent 60%), radial-gradient(farthest-corner at 100% 100%, var(--grad-color) 0%, transparent 60%);background-attachment:fixed;background-size:cover;background-repeat:no-repeat}
    .app{max-width:1200px;margin:30px auto;padding:0 24px 40px}
    .app-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
    .app-header-left{display:flex;gap:12px;align-items:center}
    .logo{cursor:pointer;font-size:34px;font-weight:800;letter-spacing:.04em;color:#0f172a;text-transform:uppercase;background:linear-gradient(to right, #0f172a, #334155);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .logo-stack{display:flex;flex-direction:column;gap:4px;align-items:flex-start}
    .app-subtitle{color:var(--mut);font-size:14px;font-weight:500}
    .app-title h1{margin:0;font-size:26px;font-weight:700;letter-spacing:.02em;color:#0f172a}
    .app-title small{color:var(--mut);font-size:13px}
    .btn{border:none;cursor:pointer;border-radius:12px;padding:8px 20px;font-size:14px;font-weight:600;transition:var(--t);white-space:nowrap;box-shadow:0 2px 4px rgba(0,0,0,0.05)}
    .btn:active{transform:scale(.98)}
    .btn-outline{background:#fff;border:1px solid var(--brd);color:var(--txt)}
    .btn-outline:hover{background:#f8fafc;border-color:var(--mut)}
    .btn-primary{background:var(--naranja);color:#fff} /* Next is Orange */
    .btn-primary:hover{background:#ea580c;box-shadow:0 4px 12px rgba(249,115,22,0.3)}
    .btn-secondary{background:var(--blue);color:#fff} /* Filter/Prev is Blue */
    .btn-secondary:hover{background:#2563eb;box-shadow:0 4px 12px rgba(59,130,246,0.3)}
    .btn-ghost{background:transparent;border:1px solid transparent;color:var(--mut)}
    .btn-ghost:hover{background:rgba(0,0,0,0.05);color:var(--txt)}
    .btn-small{padding:6px 14px;font-size:12px;border-radius:8px}
    .btn-success{background:var(--green);color:#fff}
    .btn-success:hover{background:#059669;box-shadow:0 4px 12px rgba(16,185,129,0.3)}
    .btn-danger{background:#ef4444;color:#fff}
    .btn-danger:hover{background:#cc2323;box-shadow:0 4px 12px rgba(239,68,68,0.3)}
    .btn-warning{background:#f59e0b;color:#fff}
    .btn-warning:hover{background:#d97706}
    .input{padding:10px 14px;border-radius:10px;background:#fff;border:1px solid var(--brd);color:var(--txt);font-size:14px;outline:none;transition:all var(--t);box-shadow:0 2px 4px rgba(0,0,0,0.02)}
    .input.full, .login-field .input, .filters .input, .card-body-grid .input { width: 100%; }
    .input::placeholder{color:#94a3b8}
    .input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(59,130,246,0.2)}
    .input.select{appearance:none;padding-right:30px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center;background-size:16px}
    
    .layout{display:grid;grid-template-columns:250px 1fr;gap:24px;align-items:start}
    
    .card{background:var(--bg2);border:1px solid rgba(255,255,255,0.5);border-radius:var(--r1);padding:24px;margin-bottom:24px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.03)}
    .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:12px;border-bottom:1px solid #f1f5f9}
    .card-header h2{margin:0;font-size:20px;color:#0f172a;font-weight:700}
    .card-body-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    .card-body-grid .full{grid-column:1/-1}
    .menu-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; }
    @media(max-width: 1000px) { .menu-grid { grid-template-columns: repeat(2, 1fr); } }
    @media(max-width: 600px) { .menu-grid { grid-template-columns: 1fr; } }
    .filters{display:grid;grid-template-columns:.9fr 1fr 1fr auto auto auto;gap:12px;align-items:center;margin-bottom:20px;background:#f8fafc;padding:12px;border-radius:12px;border:1px solid #f1f5f9}
    .filters-total{color:var(--mut);font-size:14px;font-weight:600}
    .tickets-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
    .ticket-card{background:#fff;border:1px solid var(--brd);border-radius:var(--r1);padding:16px;display:flex;flex-direction:column;gap:10px;transition:var(--t);box-shadow:0 2px 4px rgba(0,0,0,0.02)}
    .ticket-card:hover{border-color:var(--blue);transform:translateY(-2px);box-shadow:0 10px 15px -3px rgba(0,0,0,0.1)}
    .ticket-card.pendiente{border-left:4px solid var(--green)}
    .ticket-card.hecho{border-left:4px solid var(--naranja)}
    .ticket-header{display:flex;justify-content:space-between;align-items:center}
    .ticket-header h3{margin:0;font-size:16px;color:#0f172a;font-weight:600}
    .ticket-desc{margin:0;font-size:14px;color:#334155;line-height:1.5}
    .ticket-meta{font-size:12px;color:#64748b;background:#f1f5f9;padding:4px 8px;border-radius:6px;width:fit-content}
    .badge{padding:4px 10px;border-radius:999px;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.05em}
    .badge-pendiente{background:#dcfce7;color:#15803d}
    .badge-hecho{background:#f1f5f9;color:#475569}
    .ticket-actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    @media(max-width:880px){.app{padding:0 14px 28px}.layout{grid-template-columns:1fr}.sidebar{display:none}.card-body-grid{grid-template-columns:repeat(2,1fr)}.filters{grid-template-columns:repeat(2,1fr)}.app-header{flex-direction:column;align-items:flex-start;gap:10px}}

    #login { display:flex; align-items:center; justify-content:center; min-height: 100vh; }
    .login-card { width: 400px; background: rgba(255,255,255,0.9); backdrop-filter:blur(10px); border: 1px solid #fff; border-radius: 24px; padding: 40px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04); }
    .login-avatar { width: 100px; height: 100px; border-radius: 50%; background: #fff; margin: 0 auto 24px; display:flex; align-items:center; justify-content:center; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border: 4px solid #f8fafc; }
    .login-field { margin-bottom:16px; }
    .login-field input { background: #f8fafc; border: 1px solid #e2e8f0; }
    .login-btn { width:100%; padding:14px; border-radius:12px; background: var(--blue); color:#fff; border: none; font-weight:600; font-size:16px; box-shadow: 0 4px 6px -1px rgba(59,130,246,0.5); transition:all .2s; }
    .login-btn:hover { background: #2563eb; transform:translateY(-1px); box-shadow: 0 10px 15px -3px rgba(59,130,246,0.6); }

    .sidebar{background:rgba(255,255,255,0.8);border:1px solid #fff;border-radius:24px;padding:24px;height:calc(100% - 0px);backdrop-filter:blur(12px);box-shadow:0 4px 6px -1px rgba(0,0,0,0.05)}
    .sidebar-user{display:flex;flex-direction:column;align-items:center;gap:12px;margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid #e2e8f0}
    .sidebar-nav{display:flex;flex-direction:column;gap:8px}
    .sidebar-nav button{text-align:left;padding:12px 16px;border-radius:12px;transition:all .2s ease;font-weight:500;color:#64748b}
    .sidebar-nav button:hover{background:#f1f5f9;color:#0f172a;transform:translateX(4px)}
    .sidebar-nav button.active{background:linear-gradient(135deg, var(--blue), #2563eb);color:#fff;box-shadow:0 4px 6px -1px rgba(59,130,246,0.4)}
    
    .content{min-height:600px}
    .avatar-icon{width:100%;height:100%;max-width:120px;max-height:120px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#f1f5f9;color:#cbd5e1}
    .avatar-icon svg{width:60%;height:60%;fill:#cbd5e1}

    .data-table { width: 100%; border-collapse: collapse; }
    .data-table th { text-align: left; padding: 12px 16px; background: #f8fafc; color: var(--mut); font-weight: 600; font-size: 13px; border-bottom: 1px solid var(--brd); }
    .data-table td { padding: 12px 16px; border-bottom: 1px solid var(--brd); color: var(--txt); font-size: 14px; }
    .data-table tr:last-child td { border-bottom: none; }
    .table-container { background: #fff; border-radius: var(--r1); border: 1px solid var(--brd); overflow: hidden; }

    /* Dark Mode Styles */
    [data-theme="dark"] {
      --bg: #0b1121;
      --bg2: #0f172a;
      --brd: #1e293b;
      --txt: #f8fafc;
      --mut: #94a3b8;
      --nsoft: rgba(249, 115, 22, 0.2);
    }
    body[data-theme="dark"] {
      background-color: #020617 !important;
      background-image: radial-gradient(farthest-corner at 0% 0%, #1e293b 0%, transparent 60%), radial-gradient(farthest-corner at 100% 100%, #1e293b 0%, transparent 60%) !important;
      background-attachment: fixed !important;
      background-size: cover !important;
      background-repeat: no-repeat !important;
    }
    [data-theme="dark"] .card, 
    [data-theme="dark"] .sidebar, 
    [data-theme="dark"] .login-card {
      background: rgba(15, 23, 42, 0.6);
      border-color: rgba(59, 130, 246, 0.3);
      backdrop-filter: blur(20px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
    }
    [data-theme="dark"] .input {
      background: #1e293b;
      border-color: #334155;
      color: #f1f5f9;
    }
    [data-theme="dark"] .input:focus {
      border-color: var(--blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
    [data-theme="dark"] .logo {
      background: linear-gradient(to right, #60a5fa, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    [data-theme="dark"] .app-subtitle,
    [data-theme="dark"] .app-title small,
    [data-theme="dark"] .filters-total {
      color: #94a3b8;
    }
    [data-theme="dark"] .app-title h1,
    [data-theme="dark"] .card-header h2,
    [data-theme="dark"] .ticket-header h3 {
      color: #f1f5f9;
    }
    [data-theme="dark"] .btn-outline {
      background: transparent;
      border-color: #334155;
      color: #f1f5f9;
    }
    [data-theme="dark"] .btn-outline:hover {
      background: rgba(255,255,255,0.05);
      border-color: #475569;
    }
    [data-theme="dark"] .btn-ghost {
      color: #cbd5e1;
    }
    [data-theme="dark"] .btn-ghost:hover {
      background: rgba(255,255,255,0.1);
    }
    [data-theme="dark"] .ticket-card {
      background: rgba(30, 41, 59, 0.7);
      border-color: #334155;
    }
    [data-theme="dark"] .ticket-card:hover {
      border-color: var(--blue);
      box-shadow: 0 0 15px rgba(59, 130, 246, 0.15);
    }
    [data-theme="dark"] .ticket-desc {
      color: #cbd5e1;
    }
    [data-theme="dark"] .ticket-meta {
      background: #0f172a;
      color: #94a3b8;
    }
    [data-theme="dark"] .filters {
      background: rgba(15, 23, 42, 0.5);
      border-color: #1e293b;
    }
    [data-theme="dark"] .sidebar-nav button:hover {
      background: rgba(255,255,255,0.05);
      color: #f1f5f9;
    }
    [data-theme="dark"] .sidebar-user {
      border-color: #1e293b;
    }
    [data-theme="dark"] .card-header {
      border-color: #1e293b;
    }
    [data-theme="dark"] .login-field input {
        background: #0f172a;
        border-color: #334155;
        color: #fff;
    }
    [data-theme="dark"] .table-container {
        background: rgba(30, 41, 59, 0.7);
        border-color: #334155;
    }
    [data-theme="dark"] .data-table th {
        background: rgba(15, 23, 42, 0.5);
        color: #94a3b8;
        border-bottom-color: #334155;
    }
    [data-theme="dark"] .data-table td {
        border-bottom-color: #334155;
        color: #f1f5f9;
    }

    /* Toggle Button */
    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: var(--bg2);
      border: 1px solid var(--brd);
      cursor: pointer;
      color: var(--txt);
      transition: all .2s;
      margin-right: 16px;
    }
    .theme-toggle:hover {
      background: var(--brd);
    }
    .theme-toggle svg {
      width: 20px;
      height: 20px;
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

  </style>
</head>
<body>
  

  

  <div class="app">
    <div class="app-header">
      <div class="app-header-left">
        <button id="themeToggle" class="theme-toggle" title="Cambiar tema">
          <!-- Sun Icon -->
          <svg class="sun-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
          <!-- Moon Icon (hidden by default logic, swapped via JS) -->
        </button>
        <div class="logo-stack">
          <div class="logo">BIOHERTZ</div>
          <div class="app-subtitle">Tickets y equipos</div>
        </div>
      </div>
      <div style="display:flex; align-items:center; gap:10px;">
        <span class="filters-total" id="status"></span>
      </div>
    </div>

    <div class="layout" id="app-layout" style="display:none;">
      <aside class="sidebar">
        <div class="sidebar-user">
          <div class="login-avatar" style="width:80px; height:80px;" id="sidebar-avatar-slot"></div>
          <div id="user-nombre" class="app-title"><h1 style="font-size:14px;">Invitado</h1></div>
        </div>
        <nav class="sidebar-nav">
          <button id="navDashboard" class="btn btn-ghost" style="width:100%;">Dashboard</button>
          <button id="navTickets" class="btn btn-ghost" style="width:100%;">Tickets</button>
          <button id="navEquipos" class="btn btn-ghost" style="width:100%;">Equipos</button>
          <button id="navClientes" class="btn btn-ghost" style="width:100%;">Clientes</button>
          <button id="navSettings" class="btn btn-ghost" style="width:100%;">Ajustes</button>
          <button id="navUsers" class="btn btn-ghost" style="width:100%;">Usuarios</button>
        </nav>
      </aside>
      <main class="content">
        <section id="admin-users" style="display:none;">
          <div class="card">
            <div class="card-header">
              <h2>Administración de Usuarios</h2>
              <button id="btnRefreshUsers" class="btn btn-ghost btn-small">↻</button>
            </div>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Rol</th>
                    <th style="text-align:right;">Acciones</th>
                  </tr>
                </thead>
                <tbody id="admin-users-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <section id="dashboard" style="display:none;">
          <div class="card">
            <div class="card-header"><h2>Dashboard</h2></div>
            <div class="menu-grid">
              <div class="card">
                <div class="card-header"><h2>Pendientes asignados</h2></div>
                <div style="font-size:32px; font-weight:700;" id="assigned-count">0</div>
              </div>
              <div class="card">
                <div class="card-header"><h2>Tickets totales</h2></div>
                <div style="font-size:32px; font-weight:700;" id="total-tickets-count">0</div>
              </div>
              <div class="card">
                <div class="card-header"><h2>Equipos</h2></div>
                <div style="font-size:32px; font-weight:700;" id="total-equipos-count">0</div>
              </div>
              <div class="card">
                <div class="card-header"><h2>Clientes</h2></div>
                <div style="font-size:32px; font-weight:700;" id="total-clientes-count">0</div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-header"><h2>Mis pendientes</h2></div>
            <div id="assigned-list" class="tickets-grid"></div>
          </div>
        </section>

        <section id="menu" style="display:none;">
          <div class="card">
            <div class="card-header"><h2>Menú</h2></div>
            <div class="menu-grid">
              <button id="btnIrTickets" class="btn btn-primary">Tickets</button>
              <button id="btnIrEquipos" class="btn btn-success">Equipos</button>
            </div>
          </div>
        </section>

        <section id="settings" style="display:none;">
          <div class="card">
            <div class="card-header"><h2>Ajustes</h2></div>
            <div class="card-body" style="display:flex; align-items:center; gap:16px;">
              <div class="login-avatar" id="settings-avatar-slot" style="width:120px; height:120px;"></div>
              <div>
                <input type="file" id="avatar-file" accept="image/*" style="display:none;" />
                <button id="btnChangeAvatar" class="btn btn-ghost">Cambiar foto</button>
                <button id="btnLogout" class="btn btn-outline btn-small" style="margin-left:8px;">Cerrar sesión</button>
              </div>
            </div>
          </div>
        </section>

        <section id="clientes-section" style="display:none;">
          <div style="display:grid; gap:20px;">
            <!-- Card Creación -->
            <div class="card">
              <div class="card-header" style="justify-content:space-between;">
                 <h2>Gestión de Clientes</h2>
                 <button id="toggleClienteForm" class="btn btn-primary">Nuevo Cliente</button>
              </div>
              <div id="cliente-form" style="display:none; margin-top:16px; padding-top:16px; border-top:1px solid var(--brd);">
                <h4 style="margin-top:0; margin-bottom:12px; color:var(--blue);">Registrar Cliente</h4>
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:16px; align-items:end;">
                  <div>
                    <label style="display:block; margin-bottom:6px; font-size:13px; font-weight:600; color:var(--mut);">Nombre del Cliente</label>
                    <input id="cli-nombre" class="input full" placeholder="Ej: Juan Pérez" />
                  </div>
                  <div>
                    <label style="display:block; margin-bottom:6px; font-size:13px; font-weight:600; color:var(--mut);">Empresa</label>
                    <input id="cli-empresa" class="input full" placeholder="Ej: Biohertz S.A." />
                  </div>
                  <button id="btnCrearCliente" class="btn btn-success" style="height:42px;">Guardar Cliente</button>
                </div>
              </div>
            </div>

            <!-- Card Listado -->
            <div class="card">
              <div class="card-header">
                <div style="display:flex; align-items:center; gap:12px;">
                  <h2>Directorio</h2>
                  <span id="clientes-total" class="badge">0</span>
                </div>
              </div>
              
              <div class="filters" style="margin-bottom:20px; grid-template-columns: 1fr;">
                  <input id="cli-filtro-q" class="input full" placeholder="Buscar por nombre, empresa o ID..." />
              </div>

              <div style="display:grid; grid-template-columns: 2fr 1fr; gap:24px;">
                  <!-- Lista (Tabla) -->
                  <div class="table-container">
                      <table class="data-table">
                        <thead>
                          <tr>
                            <th>Nombre</th>
                            <th>Empresa</th>
                            <th style="text-align:right;">Acciones</th>
                          </tr>
                        </thead>
                        <tbody id="clientes-body"></tbody>
                      </table>
                  </div>
                  
                  <!-- Detalle Lateral -->
                  <div id="cliente-detalle-view" style="display:none; position:sticky; top:20px; background:var(--bg2); border:1px solid var(--brd); border-radius:var(--r2); padding:20px; height:fit-content; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
                      <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:16px; padding-bottom:12px; border-bottom:1px solid var(--brd);">
                          <h3 id="cd-nombre" style="margin:0; color:var(--blue);">Detalles</h3>
                          <button onclick="document.getElementById('cliente-detalle-view').style.display='none'" class="btn btn-ghost btn-small" title="Cerrar">✕</button>
                      </div>
                      <p style="font-weight:600; margin-bottom:12px;">Equipos Asignados</p>
                      <div id="cd-equipos-list" style="display:flex; flex-direction:column; gap:10px; max-height:calc(100vh - 200px); overflow-y:auto; padding-right:4px;"></div>
                  </div>
              </div>
            </div>
          </div>
        </section>

        <section id="nuevo-ticket" style="display:none;">
      <div class="card">
        <div class="card-header">
          <h2>Nuevo Ticket</h2>
        </div>
        <div class="card-body-grid">
          <input id="titulo" class="input full" placeholder="Título" />
          <input id="descripcion" class="input full" placeholder="Descripción" />
          <select id="asignado-select" class="input">
            <option value="">Asignar responsable (opcional)</option>
          </select>
          <input id="equipo" class="input" type="number" placeholder="ID equipo (opcional)" />
          <button id="btnCrearTicket" class="btn btn-primary">Crear Ticket</button>
        </div>
      </div>
    </section>

        <section id="tickets-section" style="display:none;">
      <div class="card">
        <div class="card-header">
          <h2>Tickets</h2>
          <div>
            <span id="tickets-total" class="muted"></span>
          </div>
        </div>
        <div id="filtros" class="filters">
          <select id="filtro-estado" class="input select">
            <option value="">Todos</option>
            <option value="pendiente">Pendiente</option>
            <option value="hecho">Terminado</option>
          </select>
          <select id="filtro-asignado-select" class="input select">
            <option value="">Asignado: Todos</option>
          </select>
          <input id="filtro-q" class="input" placeholder="Buscar" />
          <button id="btnFiltrar" class="btn btn-secondary">Filtrar</button>
          <button id="btnLimpiar" class="btn btn-ghost">Limpiar</button>
          <select id="page-size" class="input select small">
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="50" selected>50</option>
          </select>
          <button id="btnPrev" class="btn btn-secondary btn-small">Prev</button>
          <button id="btnNext" class="btn btn-primary btn-small">Next</button>
        </div>
        <div id="tickets" class="tickets-grid"></div>
      </div>
        </section>

        <section id="equipos-list" style="display:none;">
          <div style="display:grid; gap:20px;">
            <!-- Card Creación -->
            <div class="card">
              <div class="card-header" style="justify-content:space-between;">
                <h2>Gestión de Equipos</h2>
                <button id="toggleEquipoForm" class="btn btn-primary">Nuevo Equipo</button>
              </div>
              <div id="nuevo-equipo" style="display:none; margin-top:16px; padding-top:16px; border-top:1px solid var(--brd);">
                <h4 style="margin-top:0; margin-bottom:12px; color:var(--blue);">Registrar Equipo</h4>
                
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:16px; align-items:end;">
                    <!-- Info Básica -->
                    <div class="full" style="grid-column: 1/-1; margin-bottom:8px; font-weight:600; color:var(--mut); border-bottom:1px solid var(--brd); padding-bottom:4px;">Información General</div>
                    
                    <div><label class="label-sm">Nombre</label><input id="eq-nombre" class="input full" placeholder="Ej: Ecógrafo Portátil" /></div>
                    <div><label class="label-sm">Marca</label><input id="eq-marca" class="input full" placeholder="Ej: Samsung" /></div>
                    <div><label class="label-sm">Modelo</label><input id="eq-modelo" class="input full" placeholder="Ej: HS40" /></div>
                    <div><label class="label-sm">N° Serie</label><input id="eq-numero_serie" class="input full" /></div>
                    <div><label class="label-sm">Ubicación</label><input id="eq-ubicacion" class="input full" placeholder="Ej: Bodega 1" /></div>
                    <div><label class="label-sm">Aplicación</label><input id="eq-aplicacion" class="input full" placeholder="Ej: Cardiología" /></div>
                    
                    <div class="full" style="grid-column: 1/-1; margin:8px 0; font-weight:600; color:var(--mut); border-bottom:1px solid var(--brd); padding-bottom:4px;">Estado y Asignación</div>
                    
                    <div><label class="label-sm">Cliente</label><select id="eq-cliente-id" class="input full"><option value="">Seleccionar Cliente</option></select></div>
                    <div><label class="label-sm">Año Venta</label><input id="eq-anio_venta" class="input full" type="number" /></div>
                    <div><label class="label-sm">Estado</label>
                      <select id="eq-estado" class="input select full">
                        <option value="activo">Activo</option>
                        <option value="inactivo">Inactivo</option>
                      </select>
                    </div>

                    <div class="full" style="grid-column: 1/-1; margin:8px 0; font-weight:600; color:var(--mut); border-bottom:1px solid var(--brd); padding-bottom:4px;">Mantención Inicial (Opcional)</div>
                    
                    <div><label class="label-sm">Fecha</label><input id="eq-man-fecha" class="input full" type="date" /></div>
                    <div><label class="label-sm">Trabajo Realizado</label><input id="eq-man-trabajo" class="input full" /></div>
                    <div><label class="label-sm">Nota</label><input id="eq-man-nota" class="input full" /></div>
                    
                    <div style="grid-column: 1/-1; display:flex; justify-content:flex-end; margin-top:10px;">
                        <button id="btnCrearEquipo" class="btn btn-success" style="min-width:150px;">Guardar Equipo</button>
                    </div>
                </div>
              </div>
            </div>

            <!-- Card Listado -->
            <div class="card">
              <div class="card-header">
                <div style="display:flex; align-items:center; gap:12px;">
                  <h2>Inventario</h2>
                  <span id="equipos-total" class="badge">0</span>
                </div>
              </div>
              
              <div id="filtros-equipos" class="filters" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap:12px; margin-bottom:20px;">
                  <input id="eq-filtro-q" class="input" placeholder="Búsqueda General" />
                  <input id="eq-filtro-marca" class="input" placeholder="Marca" />
                  <input id="eq-filtro-modelo" class="input" placeholder="Modelo" />
                  <input id="eq-filtro-serie" class="input" placeholder="Serie" />
                  <input id="eq-filtro-cliente" class="input" placeholder="Cliente" />
                  <input id="eq-filtro-aplicacion" class="input" placeholder="Aplicación" />
                  <input id="eq-filtro-anio" class="input" type="number" placeholder="Año" />
                  <select id="eq-filtro-estado" class="input select">
                    <option value="">Estado: Todos</option>
                    <option value="activo">Activo</option>
                    <option value="inactivo">Inactivo</option>
                  </select>
                  
                  <div style="display:flex; gap:8px; grid-column: 1/-1; justify-content: flex-end;">
                      <button id="eq-btnFiltrar" class="btn btn-secondary btn-small">Filtrar</button>
                      <button id="eq-btnLimpiar" class="btn btn-ghost btn-small">Limpiar</button>
                      <div style="border-left:1px solid var(--brd); padding-left:8px; margin-left:8px; display:flex; gap:8px;">
                          <button id="eq-btnPrev" class="btn btn-secondary btn-small">Prev</button>
                          <select id="eq-page-size" class="input select small"><option value="10">10</option><option value="20">20</option><option value="50">50</option></select>
                          <button id="eq-btnNext" class="btn btn-primary btn-small">Next</button>
                      </div>
                  </div>
              </div>
              
              <div style="display:grid; grid-template-columns: 2fr 1fr; gap:24px;">
                  <!-- Lista (Tabla) -->
                  <div class="table-container">
                      <table class="data-table">
                        <thead>
                          <tr>
                            <th>Nombre</th>
                            <th>Marca/Modelo</th>
                            <th>Serie</th>
                            <th>Estado</th>
                            <th style="text-align:right;">Acciones</th>
                          </tr>
                        </thead>
                        <tbody id="equipos-body"></tbody>
                      </table>
                  </div>
                  
                  <!-- Detalle Lateral -->
                  <div id="equipo-detalle-view" style="display:none; position:sticky; top:20px; background:var(--bg2); border:1px solid var(--brd); border-radius:var(--r2); padding:20px; height:fit-content; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
                      <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:16px; padding-bottom:12px; border-bottom:1px solid var(--brd);">
                          <h3 id="ed-title" style="margin:0; color:var(--blue);">Detalles del Equipo</h3>
                          <button onclick="document.getElementById('equipo-detalle-view').style.display='none'" class="btn btn-ghost btn-small" title="Cerrar">✕</button>
                      </div>
                      <div id="ed-content" style="display:flex; flex-direction:column; gap:12px;"></div>
                      <div id="ed-actions" style="margin-top:20px; padding-top:16px; border-top:1px solid var(--brd); display:flex; gap:10px; justify-content:flex-end;"></div>
                  </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>
  
  <section id="login">
    <div class="login-card">
      <div class="login-avatar" id="login-avatar-slot"></div>
      <div class="login-field">
        <input id="email" class="input" type="email" placeholder="Correo electrónico" />
      </div>
      <div class="login-field">
        <input id="password" class="input" type="password" placeholder="Contraseña" />
      </div>
      <div class="login-actions">
        <label><input id="rememberMe" type="checkbox" /> Recordarme</label>
        <a href="#" id="toggleRegister">Crear cuenta</a>
      </div>
      <button id="btnLogin" class="login-btn">Iniciar sesión</button>
      
      <div style="margin: 16px 0; display: flex; align-items: center; gap: 10px;">
        <div style="flex: 1; height: 1px; background: #e2e8f0;"></div>
        <span style="color: #94a3b8; font-size: 12px;">O</span>
        <div style="flex: 1; height: 1px; background: #e2e8f0;"></div>
      </div>

      <a href="/auth/google" class="login-btn" style="background: #fff; color: #475569; border: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: center; gap: 10px; text-decoration: none;">
        <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.64 9.20455C17.64 8.56636 17.5827 7.95273 17.4764 7.36364H9V10.845H13.8436C13.635 11.97 13.0009 12.9232 12.0477 13.5614V15.8195H14.9564C16.6582 14.2527 17.64 11.9455 17.64 9.20455Z" fill="#4285F4"/>
          <path d="M9 18C11.43 18 13.4673 17.1941 14.9564 15.8195L12.0477 13.5614C11.2418 14.1014 10.2109 14.4205 9 14.4205C6.65591 14.4205 4.67182 12.8373 3.96409 10.71H0.957275V13.0418C2.43818 15.9832 5.48182 18 9 18Z" fill="#34A853"/>
          <path d="M3.96409 10.71C3.78409 10.17 3.68182 9.59318 3.68182 9C3.68182 8.40682 3.78409 7.83 3.96409 7.29V4.95818H0.957275C0.347727 6.17318 0 7.54773 0 9C0 10.4523 0.347727 11.8268 0.957275 13.0418L3.96409 10.71Z" fill="#FBBC05"/>
          <path d="M9 3.57955C10.3214 3.57955 11.5077 4.03364 12.4405 4.92545L15.0218 2.34409C13.4632 0.891818 11.4259 0 9 0C5.48182 0 2.43818 2.01682 0.957275 4.95818L3.96409 7.29C4.67182 5.16273 6.65591 3.57955 9 3.57955Z" fill="#EA4335"/>
        </svg>
        Iniciar con Google
      </a>
      <div id="loginResult" style="margin-top:8px; color:#ff7a00;"></div>
      <div id="registerPanel" style="display:none; margin-top:16px;">
        <div class="login-field"><input id="reg-nombre" class="input" placeholder="Nombre" /></div>
        <div class="login-field"><input id="reg-email" class="input" type="email" placeholder="Correo Gmail" /></div>
        <div class="login-field"><input id="reg-password" class="input" type="password" placeholder="Contraseña" /></div>
        <div class="login-field">
          <select id="reg-rol" class="input select">
            <option value="user">Usuario</option>
            <option value="admin">Administrador</option>
          </select>
        </div>
        <button id="btnRegister" class="btn btn-primary" style="width:100%;">Registrarse</button>
        <div id="registerResult" style="margin-top:8px; color:#ff7a00;"></div>
        <div id="googleRegister" style="margin-top:10px;"></div>
      </div>
    </div>
  </section>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="./renderer.js"></script>
</body>
</html>
